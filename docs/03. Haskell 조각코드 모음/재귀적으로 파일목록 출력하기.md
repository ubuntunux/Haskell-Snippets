    import System.Directory
    import System.FilePath.Posix
    import Control.Monad
    
    searchDir curDir = do
        contents <- getDirectoryContents curDir
        forM_ [x | x <- contents, not (elem x [".", ".."])] (\content -> do
            let curContent = joinPath [curDir, content]
            isDir <- doesDirectoryExist curContent
            if isDir
                then searchDir curContent
                else print curContent
            )
                
    main = searchDir "."